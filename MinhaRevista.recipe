from calibre.web.feeds.news import BasicNewsRecipe

class MinhaRevista(BasicNewsRecipe):
    title = 'Minha Revista Diaria'
    description = 'Revista de Noticias e Novidades.'
    language = 'pt-BR'
    encoding = 'utf-8'

    # --- DIRETRIZ 1: Ignorar data ---
    # Pega artigos independente da data de publicacao.
    oldest_article = 9999

    # --- DIRETRIZ 2: 5 Artigos ---
    # Pega no maximo 5 artigos por feed.
    max_articles_per_feed = 5

    # --- Limpeza Geral ---
    no_stylesheets = True
    
    # --- NOVA ESTRATEGIA: Scraping Manual ---
    # Removemos 'auto_cleanup' e 'print_version'.
    # Forcamos o Calibre a baixar todas as paginas e
    # manter APENAS as tags que correspondem a estas regras:
    
    keep_only_tags = [
        # Regra para jw.org (mantem a tag <article> e seu conteudo)
        dict(name='article'),
        
        # Regra para Beehiiv (mantem tags com class='content')
        # Esta e uma regra comum para blogs.
        dict(class_='content'),
        
        # Regra de backup para Beehiiv (alguns temas usam 'single-post')
        dict(class_='single-post')
    ]

    # Lista de feeds
    feeds = [
        ('JW - Novidades PT', 'https://www.jw.org/pt/Novidades/rss/WhatsNewWebArticles/feed.xml'),
        ('JW - Whats New EN', 'https://www.jw.org/en/whats-new/rss/WhatsNewWebArticles/feed.xml'),
        ('THE NEWS (Beehiiv)', 'https://rss.beehiiv.com/feeds/j9teVW9Qmi.xml'),
    ]
