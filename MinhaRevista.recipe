from calibre.web.feeds.news import BasicNewsRecipe

class MinhaRevista(BasicNewsRecipe):
    title = 'Minha Revista Diaria'
    description = 'Revista de Noticias e Novidades.'
    language = 'pt-BR'
    encoding = 'utf-8'

    # --- DIRETRIZES (Mantidas) ---
    oldest_article = 9999
    max_articles_per_feed = 5
    no_stylesheets = True

    # --- A MUDANCA PRINCIPAL ---
    # Forca o Calibre a usar um navegador real (Chromium)
    # que pode executar o JavaScript das paginas (ex: Beehiiv).
    # O padrao e 'mechanize'
    browser_type = 'webengine'

    # --- ESTRATEGIA DE EXTRACAO (Scraping Total) ---
    # Agora que o browser_type vai carregar o JavaScript,
    # podemos usar os seletores corretos para CADA site.
    
    keep_only_tags = [
        # Regra para JW.org (Palpite novo: o conteudo principal
        # esta em um 'div' com 'id="content"')
        dict(id='content'),
        
        # Regra para "THE NEWS" (Beehiiv)
        # (Com o JavaScript rodando, 'prose' e o mais provavel)
        dict(class_='prose'),
    ]

    # Lista de feeds
    feeds = [
        ('JW - Novidades PT', 'https://www.jw.org/pt/Novidades/rss/WhatsNewWebArticles/feed.xml'),
        ('JW - Whats New EN', 'https://www.jw.org/en/whats-new/rss/WhatsNewWebArticles/feed.xml'),
        ('THE NEWS (Beehiiv)', 'https://rss.beehiiv.com/feeds/j9teVW9Qmi.xml'),
    ]

    # Nao precisamos mais de 'print_version', 'use_embedded_content'
    # ou 'postprocess_html', pois estamos fazendo scraping de tudo.
